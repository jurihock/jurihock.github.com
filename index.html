<html>
<head>

	<title>jurihock.de</title>

	<style>

		.center
		{
			display: flex;
			justify-content: center;
			align-items: center;
			height: 100%;
		}

		.clear
		{
			margin: 0;
			padding: 0;
		}

		.black
		{
			background-color: black;
		}

		.white
		{
			color: white;
		}

		.serif
		{
			font-family: serif;
		}

		.large
		{
			font-size: xx-large;
		}


		.blink
		{
			animation: blink 500ms linear infinite alternate;
		}

		@keyframes blink
		{
			50% { opacity: 0; }
			100% { opacity: 1; }
		}

	</style>

	<script>

		function random(min, max)
		{
			return Math.random() * Math.abs(max - min) + Math.min(min, max);
		}

		function sleep(ms)
		{
			return new Promise(resolve => setTimeout(resolve, ms));
		}

		function type(letter, ms)
		{
			let element = document.getElementById('suffix');

			element.innerHTML += letter;

			return sleep(ms + random(-10, +10));
		}

		function erase(ms)
		{
			let element = document.getElementById('suffix');

			element.innerHTML = element.innerHTML.slice(0, -1);

			return sleep(ms + random(-10, +10));
		}

		async function print(word)
		{
			let phrase = ' ' + word + (word != 'world' ? ' ' + 'world' : '');

			for (var i = 0; i < phrase.length; i++)
			{
				await type(phrase.charAt(i), 100)
			}

			await sleep(random(1500, 5000));

			for (var i = 0; i < phrase.length; i++)
			{
				await erase(100);
			}

			await sleep(random(500, 2500));

			return word;
		}

		async function vary(word)
		{
			let datamuse = 'https://api.datamuse.com/words?rel_jjb=';
			let response = await fetch(datamuse + word);
			let words = await response.json();
			let random = Math.floor(Math.random() * words.length);

			return words[random].word;
		}

		function loop(word)
		{
			print(word).then(vary).then(loop).catch(reset);
		}

		function reset()
		{
			loop('world');
		}

	</script>

</head>
<body class="clear black white serif large">

	<div class="center">
		<div id="prefix">
			hello<span id="suffix"></span><span class="blink">_</span>
		</div>
	</div>

	<script>setTimeout(reset, random(1000, 3000))</script>

</body>
</html>
